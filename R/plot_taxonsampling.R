#' plot.taxonsampling
#'
#' S3 method for plotting _taxonsampling_ objects output by [run_TS()]).
#'
#' @param x list object of class _taxonsampling_
#'                     (generated by [run_TS()])
#' @param ... other parameters to be passed down to specific
#'            plot functions (currently unused)
#'
#' @return Nothing (called for side effects)
#'
#' @method plot taxonsampling
#'
#' @export
#'
plot.taxonsampling <- function(x, ...)
{
  if(!("outputIDs" %in% names(x))){
    warning("outputIDs object not found in input list.")
    invisible(FALSE)
  }

  nodes <- x$nodes[x$nodes$id %in% x$outputIDs, ]
  nodes$pathString <- paste(x$ts.params$taxon,
                            nodes$parent,
                            nodes$id,
                            sep = "|")
  nodes <- data.tree::as.Node(nodes, pathDelimiter = "|")
  nodes <- data.tree::ToListExplicit(nodes, unname = TRUE)
  return(networkD3::radialNetwork(nodes))

}
